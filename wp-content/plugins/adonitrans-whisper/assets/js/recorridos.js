jQuery(document).ready(function(a){a(document).on("change","#id_solicitante_recorrido",function(){var r=a(this).val();let e=a("#centro_de_costo");"0"!==r?a.ajax({url:recorridoAjax.ajaxurl,type:"POST",dataType:"json",data:{action:"get_centros_de_costo",id_solicitante:r},success:function(r){r.success&&0<r.data.length?(e.empty().append('<option value="0">Selecciona un centro de costo</option>'),a.each(r.data,function(r,o){e.append('<option value="'+o.codigo+'">'+o.nombre+"</option>")}),e.prop("disabled",!1).trigger("change")):Swal.fire({icon:"error",title:"Oops...",text:r.data.message||"No se encontraron centros de costo."})},error:function(){Swal.fire({icon:"error",title:"Error",text:"Error al cargar los centros de costo. Intenta nuevamente."})}}):(e.prop("disabled",!0).trigger("change"),e.empty().append('<option value="0">Selecciona un centro de costo</option>').trigger("change"))}),a(document).on("change","#ciudad_inicio",function(){var r=a(this).val(),e=a("#barrio_inicio"),i=a("#barrio_fin");a("#ciudad_fin").val(r).trigger("change").prop("disabled",!1),"0"!==r?(e.empty().append('<option value="0">Selecciona un barrio</option>').trigger("change"),i.empty().append('<option value="0">Selecciona un barrio</option>').trigger("change"),a.ajax({url:recorridoAjax.ajaxurl,type:"POST",dataType:"json",data:{action:"get_barrios",ciudad_id:r},success:function(r){r.success?(a.each(r.data,function(r,o){e.append('<option value="'+o+'">'+o+"</option>"),i.append('<option value="'+o+'">'+o+"</option>")}),e.prop("disabled",!1).trigger("change"),i.prop("disabled",!1).trigger("change")):Swal.fire({icon:"error",title:"Oops...",text:r.data.message||"No se encontraron barrios."})},error:function(){Swal.fire({icon:"error",title:"Error",text:"Error al cargar los barrios. Intenta nuevamente."})}})):(e.prop("disabled",!0).trigger("change"),i.prop("disabled",!0).trigger("change"),e.empty().append('<option value="0">Selecciona un barrio</option>').trigger("change"),i.empty().append('<option value="0">Selecciona un barrio</option>').trigger("change"))}),a(document).on("change","#ciudad_fin",function(){var r=a(this).val(),e=a("#barrio_fin");"0"!==r?(e.empty().append('<option value="0">Selecciona un barrio</option>'),a.ajax({url:recorridoAjax.ajaxurl,type:"POST",dataType:"json",data:{action:"get_barrios",ciudad_id:r},success:function(r){r.success?(a.each(r.data,function(r,o){e.append('<option value="'+o+'">'+o+"</option>")}),e.prop("disabled",!1)):Swal.fire({icon:"error",title:"Oops...",text:r.data.message||"No se encontraron barrios."})},error:function(){Swal.fire({icon:"error",title:"Error",text:"Error al cargar los barrios. Intenta nuevamente."})}})):(e.prop("disabled",!0),e.empty().append('<option value="0">Selecciona un barrio</option>'))}),a(document).on("click","#crear-recorrido",function(r){r.preventDefault(),a("#recorrido-form")[0].reset(),a('#wrap-recorridos .wrap-gestion-recorridos button[type="submit"]').text("Crear Solicitud"),a("#wrap-recorridos .wrap-listado-recorridos").hide(),a("#wrap-recorridos .wrap-gestion-recorridos").show()}),a(document).on("click",'#wrap-recorridos .wrap-gestion-recorridos button[type="button"]',function(r){a("#recorrido-form")[0].reset(),a("#recorrido-id").text("").val(""),a("#select-rolesusuario").val(null).trigger("change"),a("#wrap-recorridos .wrap-gestion-recorridos").hide(),a("#wrap-recorridos .wrap-listado-recorridos").show()}),a(document).on("click","#wrap-recorridos .wrap-listado-recorridos .edit-recorrido",function(r){a('#wrap-recorridos .wrap-gestion-recorridos button[type="submit"]').text("Editar Solicitud"),a("#wrap-recorridos .wrap-gestion-recorridos .title").text("Editar Solicitud"),a("#wrap-recorridos .wrap-listado-recorridos").hide(),a("#wrap-recorridos .wrap-gestion-recorridos").show();var o=a(this).data("id");a("#recorrido-form #recorrido-id").val(o),a("body").addClass("actloader"),a.ajax({url:recorridoAjax.ajaxurl,method:"POST",data:{action:"load_recorrido_data",post_id:o},success:function(r){r.success?(a.each(r.data,function(r,o){"tipo_de_recorrido"===r||"propietario_de_recorrido"===r||"conductor_del_recorrido"===r?a("#"+r).val(o).trigger("change"):a("#"+r).val(o)}),a("body").removeClass("actloader")):(a("body").removeClass("actloader"),Swal.fire({title:"Algo ha ocurrido!",text:r.data.message,icon:"error",confirmButtonText:"Aceptar"}))},error:function(){a("body").removeClass("actloader"),Swal.fire({title:"¡Error!",text:"Hubo un problema al procesar la solicitud. Por favor intenta nuevamente.",icon:"error",confirmButtonText:"Aceptar"})}})}),a(document).on("click","#wrap-recorridos .wrap-listado-recorridos .delete-recorrido",function(r){r.preventDefault();let o=a(this).data("id");Swal.fire({title:"¿Estás seguro?",text:"Esta acción eliminará el Recorrido de forma permanente.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(r=>{r.isConfirmed&&a.ajax({url:recorridoAjax.ajaxurl,method:"POST",data:{action:"delete_recorrido",post_id:o},success:function(r){r.success?Swal.fire("¡Eliminado!","El recorrido ha sido eliminado exitosamente.","success").then(()=>{var r=recorridoAjax.plugin_url+"includes/parts/panel/recorrido.php";a.ajax({url:r,method:"POST",data:{action:"render_html_panel"},success:function(r){a("#informacion").html(r),initRecorridos()},error:function(){a("#informacion").html("<p>Error al cargar el contenido. Intenta nuevamente.</p>")}})}):Swal.fire("Error",r.data.message||"No se pudo eliminar el vehículo.","error")},error:function(){Swal.fire("Error","Hubo un problema al intentar eliminar el vehículo.","error")}})})}),a(document).on("focusin","#recorrido-form",function(){a.validator.setDefaults({ignore:":hidden:not(.select2-hidden-accessible)"}),a.validator.addMethod("select2Required",function(r,o,e){return null!==r&&""!==r},"Este dato es obligatorio"),a(this).validate({rules:{id_solicitante_recorrido:{required:!0},ciudad_inicio:{required:!0},barrio_inicio:{required:!0},ciudad_fin:{required:!0},barrio_fin:{required:!0},fecha_inicio_recorrido:{required:!0},hora_inicio_recorrido:{required:!0},centro_de_costo:{select2Required:!0}},messages:{id_solicitante_recorrido:"Este dato es obligatorio",ciudad_inicio:"Este dato es obligatorio",barrio_inicio:"Este dato es obligatorio",ciudad_fin:"Este dato es obligatorio",barrio_fin:"Este dato es obligatorio",fecha_inicio_recorrido:"Este dato es obligatorio",hora_inicio_recorrido:"Este dato es obligatorio",centro_de_costo:"Este dato es obligatorio"},submitHandler:function(r){r=new FormData(r);r.append("action","create_recorrido"),a.ajax({url:recorridoAjax.ajaxurl,type:"POST",data:r,contentType:!1,processData:!1,beforeSend:function(){a("body").addClass("actloader")},success:function(r){a("body").removeClass("actloader"),r.success?Swal.fire({title:"¡Éxito!",text:r.data.message,icon:"success",confirmButtonText:"Aceptar"}).then(r=>{r.isConfirmed&&(a("#recorrido-form")[0].reset(),r=recorridoAjax.plugin_url+"includes/parts/panel/recorrido.php",a.ajax({url:r,method:"POST",data:{action:"render_html_panel"},success:function(r){a("#informacion").html(r),initRecorridos()},error:function(){a("#informacion").html("<p>Error al cargar el contenido. Intenta nuevamente.</p>")}}))}):Swal.fire({title:"Algo ha ocurrido!",text:r.data.message,icon:"error",confirmButtonText:"Aceptar"})},error:function(){a("body").removeClass("actloader"),Swal.fire({title:"¡Error!",text:"Hubo un problema al procesar el formulario. Por favor intenta nuevamente.",icon:"error",confirmButtonText:"Aceptar"})}})}})})});
//# sourceMappingURL=recorridos.js.map
