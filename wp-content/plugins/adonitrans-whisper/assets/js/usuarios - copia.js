jQuery(document).ready(function(i){function u(a){var e=i("#extra-fields-container"),r=i("#payment-fields-container");e.hide(),r.hide(),a&&(e.show(),"propietario_vehiculo"!==a&&"conductor"!==a||r.show())}i(document).on("click","#wrap-usuarios .wrap-listado-usuarios .edit-user",function(a){i("body").addClass("actloader");var s=i(this).data("userid");i("#password").text("").val("").removeAttr("required"),i("#user-form #user-id").val(s),i.ajax({url:usuarioAjax.ajaxurl,method:"POST",data:{action:"load_user_data",user_id:s},success:function(a){if(a.success){i("#user-id").val(s),i("#first-name").val(a.data.first_name),i("#last-name").val(a.data.last_name),i("#user-email").val(a.data.email),i("#select-rolesusuario").val(a.data.role).trigger("change"),i("#user-state").val(a.data.meta_estado).trigger("change"),u(a.data.role),i("#user-cedula").val(a.data.meta_cedula),i("#user-telefono").val(a.data.meta_telefono),i("#user-direccion").val(a.data.meta_direccion);var e=a.data.meta_pagos;if(Array.isArray(e)&&0<e.length){var r=!0;if(i.each(e,function(a,e){if(!e.nombre_banco||!e.no_cuenta||!e.tipo_de_cuenta)return r=!1}),r){i(".payment-row input").val("").text("");var t=i(".payment-row").first();if(t.find('input[name="nombre_banco[]"]').val(e[0].nombre_banco),t.find('input[name="no_cuenta[]"]').val(e[0].no_cuenta),t.find('select[name="tipo_de_cuenta[]"]').val(e[0].tipo_de_cuenta),1<e.length)for(var o=1;o<e.length;o++){var n=i(".payment-row").last().clone();n.find("input").val(""),n.find("select").val(""),n.find('input[name="nombre_banco[]"]').val(e[o].nombre_banco),n.find('input[name="no_cuenta[]"]').val(e[o].no_cuenta),n.find('select[name="tipo_de_cuenta[]"]').val(e[o].tipo_de_cuenta),n.append('<a href="#" class="remove-payment-row">✖</a>'),i("#repeater-payment-fields").append(n)}i("#payment-fields-container").show()}}else i(".payment-row input").val("").text("");i('#wrap-usuarios .wrap-gestion-usuarios button[type="submit"]').text("Editar Usuario"),i("#wrap-usuarios .wrap-gestion-usuarios .title").text("Editar Usuario"),i("#wrap-usuarios .wrap-listado-usuarios").hide(),i("#wrap-usuarios .wrap-gestion-usuarios").show(),i("body").removeClass("actloader")}else i("body").removeClass("actloader"),Swal.fire({title:"Algo ha ocurrido!",text:a.data.message,icon:"error",confirmButtonText:"Aceptar"})}})}),i(document).on("click","#wrap-usuarios .wrap-listado-usuarios .delete-user",function(a){a.preventDefault();var e=i(this).data("userid");Swal.fire({title:"¿Estás seguro?",text:"Esta acción eliminará al usuario de forma permanente.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(a=>{a.isConfirmed&&i.ajax({url:usuarioAjax.ajaxurl,method:"POST",data:{action:"delete_user",user_id:e},success:function(a){a.success?Swal.fire("¡Eliminado!","El usuario ha sido eliminado exitosamente.","success").then(()=>{var a=usuarioAjax.plugin_url+"includes/parts/panel/usuario.php";i.ajax({url:a,method:"GET",success:function(a){i("#informacion").html(a),initUsuarios()},error:function(){i("#informacion").html("<p>Error al cargar el contenido. Intenta nuevamente.</p>")}})}):Swal.fire("Error",a.data.message||"No se pudo eliminar el usuario.","error")},error:function(){Swal.fire("Error","Hubo un problema al intentar eliminar el usuario.","error")}})})}),i(document).on("click","#crear-usuario",function(a){a.preventDefault(),i("#user-form")[0].reset(),i('#wrap-usuarios .wrap-gestion-usuarios button[type="submit"]').text("Crear Usuario"),i("#wrap-usuarios .wrap-listado-usuarios").hide(),i("#wrap-usuarios .wrap-gestion-usuarios").show()}),i(document).on("click",'#wrap-usuarios .wrap-gestion-usuarios button[type="button"]',function(a){i("#user-form")[0].reset(),i("#user-id").text("").val(""),i("#select-rolesusuario").val(null).trigger("change"),i("#wrap-usuarios .wrap-gestion-usuarios").hide(),i("#wrap-usuarios .wrap-listado-usuarios").show()}),i(document).on("change","#select-rolesusuario",function(a){a.preventDefault(),u(i(this).val())}),i(document).on("click","#add-payment-row",function(a){a.preventDefault();a=i(".payment-row").last().clone();a.find("input").val(""),a.find("select").val(""),a.find(".remove-payment-row").remove(),a.append('<a href="#" class="remove-payment-row">✖</a>'),i("#repeater-payment-fields").append(a)}),i(document).on("click",".remove-payment-row",function(a){a.preventDefault(),i(this).closest(".payment-row").remove()}),i(document).on("click","#generate-password",function(a){a.preventDefault();a=(()=>{for(var a="#$%&/=!",e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="0123456789",t=e+"abcdefghijklmnopqrstuvwxyz"+r+a,o="",n=0;n<2;)for(var s,o="",n=0,i=0;i<12;i++){if(0===i||Math.random()<.7)s=t.charAt(Math.floor(Math.random()*t.length));else{if(s=r.charAt(Math.floor(Math.random()*r.length)),0<i&&o[i-1]===s){i--;continue}n++}o+=s}return/[A-Z]/.test(o)||(e=e.charAt(Math.floor(Math.random()*e.length)),o=o.slice(0,Math.floor(Math.random()*o.length))+e+o.slice(Math.floor(Math.random()*o.length)+1)),/[#$%&/=!]/.test(o)||(o+=a.charAt(Math.floor(Math.random()*a.length))),o})();i("#password").val(a)}),i(document).on("blur","#user-form #password",function(a){var e=checkPassword(i(this).val()),r=!i("#user-id").val();!e||r?i("#user-form button[type='submit']").prop("disabled",!0):i("#user-form button[type='submit']").prop("disabled",!1)}),i(document).on("submit","#user-form",function(a){a.preventDefault(),i("body").addClass("actloader");a=new FormData(this);a.append("action","create_user"),i.ajax({url:usuarioAjax.ajaxurl,type:"POST",data:a,contentType:!1,processData:!1,success:function(a){i("body").removeClass("actloader"),a.success?Swal.fire({title:"¡Éxito!",text:a.data.message,icon:"success",confirmButtonText:"Aceptar"}).then(a=>{a.isConfirmed&&(i("#user-form")[0].reset(),a=usuarioAjax.plugin_url+"includes/parts/panel/usuario.php",i.ajax({url:a,method:"GET",success:function(a){i("#informacion").html(a),initUsuarios()},error:function(){i("#informacion").html("<p>Error al cargar el contenido. Intenta nuevamente.</p>")}}),i("#user-form")[0].reset())}):Swal.fire({title:"Algo ha ocurrido!",text:a.data.message,icon:"error",confirmButtonText:"Aceptar"})},error:function(a,e,r){i("body").removeClass("actloader"),Swal.fire({title:"¡Error!",text:"Hubo un problema al procesar el formulario. Por favor intenta nuevamente.",icon:"error",confirmButtonText:"Aceptar"})}})})});
//# sourceMappingURL=usuarios - copia.js.map
