function t(){jQuery("#table-empresas").DataTable({language:{url:"https://cdn.datatables.net/plug-ins/1.11.5/i18n/es-ES.json"}}),jQuery("#administradores_empresa").select2({placeholder:"Selecciona un Valor",allowClear:!0,width:"100%"})}jQuery(document).ready(function(r){r(document).on("click","#crear-empresa",function(e){e.preventDefault(),r("#empresa-form")[0].reset(),r('#wrap-empresas .wrap-gestion-empresas button[type="submit"]').text("Crear Empresa"),r("#wrap-empresas .wrap-listado-empresas").hide(),r("#wrap-empresas .wrap-gestion-empresas").show()}),r(document).on("click","#wrap-empresas .wrap-gestion-empresas #cancelar-empresa-btn",function(e){r("#empresa-form")[0].reset(),r("#empresa-id").text("").val(""),r("#administradores_empresa").val(null).trigger("change"),r(".select2-selection__clear").remove(),r(".centro-costo:gt(0)").remove(),r(".centro-costo input").val(""),r("#wrap-empresas .wrap-gestion-empresas").hide(),r("#wrap-empresas .wrap-listado-empresas").show()}),r(document).on("click","#wrap-empresas .wrap-listado-empresas .edit-empresa",function(e){r('#wrap-empresas .wrap-gestion-empresas button[type="submit"]').text("Editar Empresa"),r("#wrap-empresas .wrap-gestion-empresas .title").text("Editar Empresa"),r("#wrap-empresas .wrap-listado-empresas").hide(),r("#wrap-empresas .wrap-gestion-empresas").show();var a=r(this).data("id");r("#empresa-form #empresa-id").val(a),r("body").addClass("actloader"),r.ajax({url:empresaAjax.ajaxurl,method:"POST",data:{action:"load_empresa_data",post_id:a},success:function(e){e.success?(r.each(e.data,function(e,a){var t;"administradores_empresa"===e?(t=a.map(function(e){return e.ID}),r("#administradores_empresa").val(t).trigger("change")):"estado_de_la_empresa"===e?r("#"+e).val(a).trigger("change"):"centros_de_costos_empresa"===e&&"administradores_empresa"===e||r("#"+e).val(a)}),e.data.centros_de_costos_empresa&&0<e.data.centros_de_costos_empresa.length&&r.each(e.data.centros_de_costos_empresa,function(e,a){var t=r(".centro-costo").first().clone();t.find("label").attr("for","nombre-"+e),t.find('input[name="codigo_centro[]"]').val(a.codigo).attr("id","codigo-"+e).attr("name","codigo_centro[]"),t.find('input[name="nombre_centro[]"]').val(a.nombre).attr("id","nombre-"+e).attr("name","nombre_centro[]"),r(".wrap-datos").append(t)}),e.data.documentos_de_la_empresa&&0<e.data.documentos_de_la_empresa.length&&(r("#documentos-container").empty(),r.each(e.data.documentos_de_la_empresa,function(e,a){a=`<div class="document-row" data-document-id="${a.id}">
                                    <a href="${a.url}" target="_blank">${a.nombre||"Ver Documento"}</a>
                                    <button type="button" class="button remove-documento">Eliminar</button>
                                </div>
                            `;r("#documentos-container").append(a)})),r(".centro-costo").first().remove(),r("body").removeClass("actloader")):(r("body").removeClass("actloader"),Swal.fire({title:"Algo ha ocurrido!",text:e.data.message,icon:"error",confirmButtonText:"Aceptar"}))}})}),r(document).on("click","#wrap-empresas .wrap-listado-empresas .delete-empresa",function(e){e.preventDefault();let a=r(this).data("id");Swal.fire({title:"¿Estás seguro?",text:"Esta acción eliminará la Empresa de forma permanente.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&r.ajax({url:empresaAjax.ajaxurl,method:"POST",data:{action:"delete_empresa",post_id:a},success:function(e){e.success?Swal.fire("¡Eliminado!","El empresa ha sido eliminado exitosamente.","success").then(()=>{var e=empresaAjax.plugin_url+"includes/parts/panel/empresa.php";r.ajax({url:e,method:"POST",data:{action:"render_html_panel"},success:function(e){r("#informacion").html(e),t()},error:function(){r("#informacion").html("<p>Error al cargar el contenido. Intenta nuevamente.</p>")}})}):Swal.fire("Error",e.data.message||"No se pudo eliminar el vehículo.","error")},error:function(){Swal.fire("Error","Hubo un problema al intentar eliminar el vehículo.","error")}})})}),r(document).on("click","#add-centro-row",function(e){e.preventDefault();var e=r(".wrap-datos .centro-costo").length,a=r(".centro-costo").last().clone();a.find("label").attr("for","centro-costo-"+e),a.find("input").val("").attr("id","centro-costo-"+e),a.find(".remove-payment-row").remove(),r(".wrap-datos").append(a)}),r(document).on("click",".remove-centro-row",function(e){e.preventDefault();var e=r(".wrap-datos"),a=r(this).closest(".centro-costo");1<e.find(".centro-costo").length?a.remove():Swal.fire({icon:"warning",title:"No se puede eliminar",text:"Debe haber al menos una franja horaria configurada",confirmButtonText:"Entendido"})});let a={pdf:empresaAjax.plugin_url+"assets/images/PDF.svg",doc:empresaAjax.plugin_url+"assets/images/WORD.svg",docx:empresaAjax.plugin_url+"assets/images/WORD.svg",xls:empresaAjax.plugin_url+"assets/images/EXCEL.svg",xlsx:empresaAjax.plugin_url+"assets/images/EXCEL.svg",default:empresaAjax.plugin_url+"assets/images/OTRO.svg"};r(document).on("click","#add-documento",function(e){e.preventDefault();e=`
                <div class="document-row">
                    <input type="file" name="documentos_de_la_empresa[]" class="documento-input" accept=".xlsx,.xls,.doc,.docx,.pdf">
                    <img src="${a.default}" alt="Icono del archivo" class="document-icon" style="width: 32px; height: 32px;">
                    <button type="button" class="button remove-documento">Eliminar</button>
                </div>
            `;r("#documentos-container").append(e)}),r(document).on("change",".documento-input",function(){var e=this.files[0];e&&(e=e.name.split(".").pop().toLowerCase(),e=a[e]||a.default,r(this).siblings(".document-icon").attr("src",e))}),r(document).on("click",".remove-documento",function(){var e=r(this).closest(".document-row").data("document-id"),a=r("#documentos_eliminados"),t=a.val()?JSON.parse(a.val()):[];e&&!t.includes(e)&&(t.push(e),a.val(JSON.stringify(t))),r(this).closest(".document-row").remove()}),r(document).on("focusin","#empresa-form",function(){r(this).validate({rules:{estado_de_la_empresa:{required:!0},nombre_empresa:{required:!0},administradores_empresa:{required:!0}},messages:{estado_de_la_empresa:"Esta información es necesaria",nombre_empresa:"Esta información es necesaria",administradores_empresa:"Esta información es necesaria"},submitHandler:function(e){e=new FormData(e);e.append("action","create_empresa"),r.ajax({url:empresaAjax.ajaxurl,type:"POST",data:e,contentType:!1,processData:!1,beforeSend:function(){r("body").addClass("actloader")},success:function(e){r("body").removeClass("actloader"),e.success?Swal.fire({title:"¡Éxito!",text:e.data.message,icon:"success",confirmButtonText:"Aceptar"}).then(e=>{e.isConfirmed&&(r("#empresa-form")[0].reset(),e=empresaAjax.plugin_url+"includes/parts/panel/empresa.php",r.ajax({url:e,method:"POST",data:{action:"render_html_panel"},success:function(e){r("#informacion").html(e),t()},error:function(){r("#informacion").html("<p>Error al cargar el contenido. Intenta nuevamente.</p>")}}))}):Swal.fire({title:"Algo ha ocurrido!",text:e.data.message,icon:"error",confirmButtonText:"Aceptar"})},error:function(){r("body").removeClass("actloader"),Swal.fire({title:"¡Error!",text:"Hubo un problema al procesar el formulario. Por favor intenta nuevamente.",icon:"error",confirmButtonText:"Aceptar"})}})}})})});
//# sourceMappingURL=empresas.js.map
